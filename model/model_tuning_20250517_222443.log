2025-05-17 22:24:43,411 - INFO - Loading preprocessed data...
2025-05-17 22:24:43,418 - INFO - Preprocessed data loaded successfully.
2025-05-17 22:24:43,418 - INFO - Models to tune: ['Random Forest', 'XGBoost', 'LightGBM']
2025-05-17 22:24:43,418 - INFO - 
==================================================
2025-05-17 22:24:43,418 - INFO - Tuning Random Forest...
2025-05-17 22:24:43,418 - INFO - ==================================================
2025-05-17 22:24:43,418 - INFO - Starting hyperparameter search...
2025-05-17 22:24:43,418 - INFO - Parameter grid: {'n_estimators': [100, 200, 300], 'max_depth': [10, 15, 20], 'min_samples_split': [5, 10, 15], 'min_samples_leaf': [4, 8, 12], 'max_features': ['sqrt', 'log2', 0.7], 'bootstrap': [True], 'oob_score': [True, False], 'ccp_alpha': [0.0, 0.001, 0.01]}
2025-05-18 00:00:22,352 - INFO - Best parameters: {'bootstrap': True, 'ccp_alpha': 0.01, 'max_depth': 20, 'max_features': 0.7, 'min_samples_leaf': 4, 'min_samples_split': 5, 'n_estimators': 200, 'oob_score': True}
2025-05-18 00:00:22,353 - INFO - Best cross-validation score (R2): 0.6639
2025-05-18 00:00:22,353 - INFO - Training final model with best parameters...
2025-05-18 00:00:28,183 - INFO - 
Tuned Random Forest Metrics:
2025-05-18 00:00:28,183 - INFO - R2 Score: 0.7184
2025-05-18 00:00:28,183 - INFO - RMSE: 147.34
2025-05-18 00:00:28,183 - INFO - MAPE: 13.09%
2025-05-18 00:00:28,183 - INFO - MAE: 92.13
2025-05-18 00:00:28,183 - INFO - Tuning completed in 5744.76 seconds (95.75 minutes)
2025-05-18 00:00:28,183 - INFO - Saving tuned model to model_tuning_outputs/tuned_random_forest.pkl
2025-05-18 00:00:28,391 - INFO - 
==================================================
2025-05-18 00:00:28,391 - INFO - Tuning XGBoost...
2025-05-18 00:00:28,391 - INFO - ==================================================
2025-05-18 00:00:28,392 - INFO - Starting hyperparameter search...
2025-05-18 00:00:28,392 - INFO - Parameter grid: {'n_estimators': [100, 200, 300], 'learning_rate': [0.01, 0.05, 0.1], 'max_depth': [4, 6, 8], 'min_child_weight': [1, 3, 5], 'gamma': [0, 0.1, 0.2], 'subsample': [0.8, 0.9, 1.0], 'colsample_bytree': [0.8, 0.9, 1.0], 'reg_alpha': [0, 0.1, 0.5], 'reg_lambda': [1, 1.5, 2]}
2025-05-18 00:00:34,879 - INFO - Best parameters: {'subsample': 0.8, 'reg_lambda': 2, 'reg_alpha': 0.5, 'n_estimators': 300, 'min_child_weight': 1, 'max_depth': 8, 'learning_rate': 0.1, 'gamma': 0.2, 'colsample_bytree': 0.8}
2025-05-18 00:00:34,880 - INFO - Best cross-validation score (R2): 0.6821
2025-05-18 00:00:34,880 - INFO - Training final model with best parameters...
2025-05-18 00:00:35,729 - INFO - 
Tuned XGBoost Metrics:
2025-05-18 00:00:35,729 - INFO - R2 Score: 0.7496
2025-05-18 00:00:35,729 - INFO - RMSE: 138.95
2025-05-18 00:00:35,729 - INFO - MAPE: 12.01%
2025-05-18 00:00:35,729 - INFO - MAE: 85.85
2025-05-18 00:00:35,729 - INFO - Tuning completed in 7.34 seconds (0.12 minutes)
2025-05-18 00:00:35,729 - INFO - Saving tuned model to model_tuning_outputs/tuned_xgboost.pkl
2025-05-18 00:00:35,736 - INFO - 
==================================================
2025-05-18 00:00:35,736 - INFO - Tuning LightGBM...
2025-05-18 00:00:35,736 - INFO - ==================================================
2025-05-18 00:00:35,737 - INFO - Starting hyperparameter search...
2025-05-18 00:00:35,737 - INFO - Parameter grid: {'n_estimators': [100, 200, 300], 'learning_rate': [0.01, 0.05, 0.1], 'max_depth': [5, 7, 9], 'num_leaves': [31, 50, 80], 'min_child_samples': [20, 30, 50], 'min_child_weight': [0.001, 0.01, 0.1], 'reg_alpha': [0, 0.1, 0.5], 'reg_lambda': [0, 0.1, 0.5], 'subsample': [0.8, 0.9, 1.0]}
2025-05-18 00:01:20,580 - INFO - Best parameters: {'subsample': 1.0, 'reg_lambda': 0.1, 'reg_alpha': 0.5, 'num_leaves': 31, 'n_estimators': 300, 'min_child_weight': 0.01, 'min_child_samples': 20, 'max_depth': 9, 'learning_rate': 0.05}
2025-05-18 00:01:20,580 - INFO - Best cross-validation score (R2): 0.6727
2025-05-18 00:01:20,581 - INFO - Training final model with best parameters...
2025-05-18 00:01:21,583 - INFO - 
Tuned LightGBM Metrics:
2025-05-18 00:01:21,583 - INFO - R2 Score: 0.7257
2025-05-18 00:01:21,583 - INFO - RMSE: 145.44
2025-05-18 00:01:21,583 - INFO - MAPE: 13.73%
2025-05-18 00:01:21,583 - INFO - MAE: 95.12
2025-05-18 00:01:21,584 - INFO - Tuning completed in 45.85 seconds (0.76 minutes)
2025-05-18 00:01:21,584 - INFO - Saving tuned model to model_tuning_outputs/tuned_lightgbm.pkl
2025-05-18 00:01:21,589 - INFO - 
Tuning Results:
2025-05-18 00:01:21,597 - INFO - 
                 Model  ...  Tuning Time (s)
0  Tuned Random Forest  ...      5744.764533
1        Tuned XGBoost  ...         7.338023
2       Tuned LightGBM  ...        45.847050

[3 rows x 7 columns]
2025-05-18 00:01:21,598 - INFO - Results saved to model_tuning_outputs/tuning_results.csv
2025-05-18 00:01:21,672 - INFO - 
Best model: Tuned XGBoost
2025-05-18 00:01:21,672 - INFO - Best model R2 Score: 0.7496
2025-05-18 00:01:21,672 - INFO - Saving best model to model_tuning_outputs/best_tuned_model.pkl
2025-05-18 00:01:21,679 - INFO - 
Hyperparameter tuning complete! Results have been saved.
2025-05-18 00:01:21,679 - INFO - Detailed log saved to model_tuning_outputs/model_tuning_20250517_222443.log
2025-05-18 00:01:21,679 - INFO - All outputs saved in directory: model_tuning_outputs
